#include "ServerSocket.h"

namespace System
{ 
	namespace Net
	{
		//////////////////////////////////////////////////////////////////////////
		ServerSocket::ServerSocket(void)
		//////////////////////////////////////////////////////////////////////////
		{
		}

		//////////////////////////////////////////////////////////////////////////
		ServerSocket::~ServerSocket(void)
		//////////////////////////////////////////////////////////////////////////
		{
		}


		//////////////////////////////////////////////////////////////////////////
		bool ServerSocket::Bind(const InetAddr& addr)
		//////////////////////////////////////////////////////////////////////////
		{
			m_oAddress = addr;		
			return bind(m_oSock, (const sockaddr*)&addr, sizeof(sockaddr)) != SOCKET_ERROR;
		}

		//////////////////////////////////////////////////////////////////////////
		bool ServerSocket::Listen()
		//////////////////////////////////////////////////////////////////////////
		{
			return listen(m_oSock, SOCKET_BACKLOG) != SOCKET_ERROR;
		}

		//////////////////////////////////////////////////////////////////////////
		Socket ServerSocket::Accept( )
		//////////////////////////////////////////////////////////////////////////
		{
			InetAddr address;
			int len = sizeof(sockaddr);

			SOCKET s = accept(m_oSock, (sockaddr*)&address, (socklen_t *) &len);

			return Socket ( s, address );
		}

	}
}
